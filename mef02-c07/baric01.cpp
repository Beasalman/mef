#include "baric01.h"

/* --------------------------------------------------------- */

void baric01 (celem2d *ef, cnodo2d *p, vector <double> w) {

    cnodo2d *a, *b, *c;

    a = ef->nodos [0];
    b = ef->nodos [1];
    c = ef->nodos [2];
                    
    w[2] = ((p->x - a->x) * (b->y - a->y) - (p->y - a->y) * (b->x - a->x)) / ((c->x - a->x) * (b->y - a->y) - (c->y - a->y) * (b->x - a->x));
    w[1] = ((p->x - a->x) - w[2] * (c->x - a->x)) / (b->x - a->x);
    w[0] = 1.0 - w[1] - w[2];
}

/* --------------------------------------------------------- */

void baric01 (celem2d *ef, cnodo2d *p, cnodo2d *w) {

    cnodo2d *a, *b, *c;

    // **********************************************************************************
    //cout << " [BARIC01] Elemento: " << ef->id;
    //cout << "         Nodo: " << p->x << " " << p->y;
    //cout << "         Contains: " << ef->contains (p) << endl;
    // **********************************************************************************

    a = ef->nodos [0];
    b = ef->nodos [1];
    c = ef->nodos [2];

    // MÃ©todo de Cramer.

    double d = (b->x - a->x) * (c->y - a->y) - (b->y - a->y) * (c->x - a->x);
    double d1 = (p->x - a->x) * (c->y - a->y) - (p->y - a->y) * (c->x - a->x);
    double d2 = (b->x - a->x) * (p->y - a->y) - (b->y - a->y) * (p->x - a->x);
    w->x = d1 / d;
    w->y = d2 / d;
}

/* --------------------------------------------------------- */


/*
    double d1 = (c->x - a->x) * (b->y - a->y) - (c->y - a->y) * (b->x - a->x);
    double d2 = (b->x - a->x);

    if (abs (d1) > 1.e-12 && abs (d2) > 1.e-12) {
        w->y = ((p->x - a->x) * (b->y - a->y) - (p->y - a->y) * (b->x - a->x)) / d1;
        w->x = ((p->x - a->x) - w->y * (c->x - a->x)) / d2;
    } else {
        w->x = ((p->x - c->x) * (b->y - c->y) - (p->y - c->y) * (a->x - c->x)) / ((a->x - c->x) * (b->y - c->y) - (a->y - c->y) * (b->x - c->x));
        w->y = (c->x - (a->x - c->x) * w->x) / (b->x - c->x);
    }

    // **********************************************************************************
    cout << "         Baric: " << w->x << " " << w->y << endl;
    // **********************************************************************************
*/

